blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown::hugo_build()
?build.site
blogdown::build_site()
getwd
getwd()
library(tidyverse)
blogdown:::serve_site()
blogdown:::new_post_addin()
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(rvest)
library(beepr)
library(gganimate)
library(extrafont)
library(knitr)
theme_ice <- theme_bw() +
theme(
text = element_text(family = "Consolas"),
plot.title = element_text(hjust = .5),
plot.subtitle = element_text(hjust = .5),
panel.grid.minor = element_blank(),
legend.position = "bottom")
my_labs  = list(labs(caption = "IceAnalysis.com | @IceAnalysis"))
team_list1819 <- list()
year_list1819 <- list()
teams1819 <- c("ANA",
"ARI",
"BOS",
"BUF",
"CAR",
"CBJ",
"CGY",
"CHI",
"COL",
"DAL",
"DET",
"EDM",
"FLA",
"LAK",
"MIN",
"MTL",
"NSH",
"NJD",
"NYI",
"NYR",
"OTT",
"PHI",
"PIT",
"SJS",
"STL",
"TBL",
"TOR",
"VAN",
"VEG",
"WPG",
"WSH")
for(j in 2018:2019) {
for(i in teams1819) {
team_url <- paste0("https://www.hockey-reference.com/teams/",i,"/",j,"_games.html")
webpage <- read_html(team_url)
team_tbl <- webpage %>%
html_nodes("table") %>%
html_table(fill = T)
team_df <- data.frame(team_tbl[[1]])
team_df$team = i
team_df$year = j
team_list1819[[i]] <- team_df
}
year_list1819[[j]] <- data.frame(data.table::rbindlist(team_list1819))
}  ; beep()
df1819 <- data.frame(data.table::rbindlist(year_list1819))
team_list1517 <- list()
year_list1517 <- list()
teams1517 <- c("ANA",
"ARI",
"BOS",
"BUF",
"CAR",
"CBJ",
"CGY",
"CHI",
"COL",
"DAL",
"EDM",
"FLA",
"LAK",
"MIN",
"MTL",
"NSH",
"NJD",
"NYI",
"NYR",
"OTT",
"PHI",
"PIT",
"SJS",
"STL",
"TBL",
"TOR",
"VAN",
"WPG",
"WSH")
for(j in 2015:2017) {
for(i in teams1517) {
team_url <- paste0("https://www.hockey-reference.com/teams/",i,"/",j,"_games.html")
webpage <- read_html(team_url)
team_tbl <- webpage %>%
html_nodes("table") %>%
html_table(fill = T)
team_df <- data.frame(team_tbl[[1]])
team_df$team = i
team_df$year = j
team_list1517[[i]] <- team_df
}
year_list1517[[j]] <- data.frame(data.table::rbindlist(team_list1517))
}  ; beep()
df1517 <- data.frame(data.table::rbindlist(year_list1517, fill = T))
df_all <- rbind(df1517, df1819)
df <- subset(df_all, GP != "GP") %>%
select(team, year, GP, Date, W, L, OL,) %>%
mutate(GP = as.integer(GP),
Date = as.Date(Date),
W = as.integer(W),
L = as.integer(L),
OL = as.integer(OL),
div = ifelse(team %in% c("TBL",
"BOS",
"TOR",
"MTL",
"FLA",
"BUF",
"DET",
"OTT"), "Atlantic",
ifelse(team %in% c("WSH",
"NYI",
"PIT",
"CAR",
"CBJ",
"PHI",
"NYR",
"NJD"), "Metro",
ifelse(team %in% c("NSH",
"WPG",
"STL",
"DAL",
"COL",
"CHI",
"MIN"), "Central", "Pacific")))) %>%
group_by(team, year) %>%
mutate(pts = W*2 + OL*1,
p_82 = (pts / GP) * 82) %>%
ungroup()
density_df <- df %>%
group_by(team, year) %>%
mutate(final = ifelse(GP == 82, pts, NA)) %>%
fill(final, .direction = "up") %>%
mutate(diff = p_82 - final)
sd_df <- density_df %>%
group_by(GP) %>%
summarize(mean = mean(diff),
upper = quantile(diff, .95),
lower = quantile(diff, .05)) %>%
mutate(safe = 95 + upper,
out = 95 + lower) %>%
filter(GP >= 10,
GP < 82)
sd_df %>%
select(GP, safe, out) #%>%
save(df_all, filei = "df_all.Rda")
save(df_all, file = "df_all.Rda")
food_df <- load("df_all.Rda")
food_df <- load("/content/post/df_all.Rda")
library(here)
here("/content/post")
food_df <- load("content/post/df_all.Rda")
food_df
View(food_df)
