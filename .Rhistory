axis.line.x = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
plot.title = element_text(hjust = .5),
plot.subtitle = element_text(hjust = .5)) +
labs(title = paste0(i, " 2016-2018 Even Strength Shots"),
subtitle = "Defensemen",
y = "<- Number of Left Shots | Number of Right Shots ->",
x = "Distance from Goal") +
my_labs +
ggsave(path = here::here("static/img/pref/"), filename = paste0("D-Side-Pref-", i, ".png"), height = 6, units = "in")
print(dchart)
fchart <- ggplot() +
geom_histogram(data = subset(team_df, dist > 0 & shooterName %in% top_12F$shooterName), aes(x = dist - 11, y = -..count..), fill = "orange", binwidth = 2) +
geom_histogram(data = subset(team_df, dist < 0 & shooterName %in% top_12F$shooterName), aes(x = -dist - 11, y = ..count..), fill = "purple", binwidth = 2) +
geom_text(data = subset(team_df, dist > 0 & shooterName %in% top_12F$shooterName), aes(x = 75, y = 10, label = ifelse(right_prop > .5, paste0(round(100*right_prop),"%"), NA)), family = "Consolas") +
geom_text(data = subset(team_df, dist < 0 & shooterName %in% top_12F$shooterName), aes(x = 75, y = -10, label = ifelse(left_prop > .5, paste0(round(100*left_prop),"%"), NA)), family = "Consolas") +
coord_flip() +
facet_wrap(~shooterName) +
theme_ice +
scale_y_continuous(expand = c(0,0)) +
geom_hline(yintercept = 0) +
theme(axis.text.x = element_blank(),
axis.text.y = element_text(),
axis.line.x = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
plot.title = element_text(hjust = .5),
plot.subtitle = element_text(hjust = .5)) +
labs(title = paste0(i, " 2016-2018 Even Strength Shots"),
subtitle = "Forwards",
y = " <- Number of Left Shots | Number of Right Shots ->",
x = "Distance from Goal") +
my_labs +
ggsave(path = here::here("static/img/pref/"), filename = paste0("F-Side-Pref-", i, ".png"), height = 9, units = "in")
print(fchart)
fchart <- ggplot() +
geom_histogram(data = subset(team_df, dist > 0 & shooterName %in% top_12F$shooterName), aes(x = dist - 11, y = -..count..), fill = "orange", binwidth = 2) +
geom_histogram(data = subset(team_df, dist < 0 & shooterName %in% top_12F$shooterName), aes(x = -dist - 11, y = ..count..), fill = "purple", binwidth = 2) +
geom_text(data = subset(team_df, dist > 0 & shooterName %in% top_12F$shooterName), aes(x = 75, y = 10, label = ifelse(right_prop >= .5, paste0(round(100*right_prop),"%"), NA)), family = "Consolas") +
geom_text(data = subset(team_df, dist < 0 & shooterName %in% top_12F$shooterName), aes(x = 75, y = -10, label = ifelse(left_prop > .5, paste0(round(100*left_prop),"%"), NA)), family = "Consolas") +
coord_flip() +
facet_wrap(~shooterName) +
theme_ice +
scale_y_continuous(expand = c(0,0)) +
geom_hline(yintercept = 0) +
theme(axis.text.x = element_blank(),
axis.text.y = element_text(),
axis.line.x = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
plot.title = element_text(hjust = .5),
plot.subtitle = element_text(hjust = .5)) +
labs(title = paste0(i, " 2016-2018 Even Strength Shots"),
subtitle = "Forwards",
y = " <- Number of Left Shots | Number of Right Shots ->",
x = "Distance from Goal") +
my_labs +
ggsave(path = here::here("static/img/pref/"), filename = paste0("F-Side-Pref-", i, ".png"), height = 9, units = "in")
dchart <- ggplot() +
geom_histogram(data = subset(team_df, dist > 0 & shooterName %in% top_6D$shooterName), aes(x = dist - 11, y = -..count..), fill = "orange", binwidth = 2) +
geom_histogram(data = subset(team_df, dist < 0 & shooterName %in% top_6D$shooterName), aes(x = -dist - 11, y = ..count..), fill = "purple", binwidth = 2) +
geom_text(data = subset(team_df, dist > 0 & shooterName %in% top_6D$shooterName), aes(x = 75, y = 10, label = ifelse(right_prop >= .5, paste0(round(100*right_prop),"%"), NA)), family = "Consolas") +
geom_text(data = subset(team_df, dist < 0 & shooterName %in% top_6D$shooterName), aes(x = 75, y = -10, label = ifelse(left_prop > .5, paste0(round(100*left_prop),"%"), NA)), family = "Consolas") +
coord_flip() +
facet_wrap(~shooterName) +
theme_ice +
scale_y_continuous(expand = c(0,0)) +
geom_hline(yintercept = 0) +
theme(axis.text.x = element_blank(),
axis.text.y = element_text(),
axis.line.x = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
plot.title = element_text(hjust = .5),
plot.subtitle = element_text(hjust = .5)) +
labs(title = paste0(i, " 2016-2018 Even Strength Shots"),
subtitle = "Defensemen",
y = "<- Number of Left Shots | Number of Right Shots ->",
x = "Distance from Goal") +
my_labs +
ggsave(path = here::here("static/img/pref/"), filename = paste0("D-Side-Pref-", i, ".png"), height = 6, units = "in")
print(fchart)
print(dchart)
team_df <- df %>%
filter(teamCode == "S.J") %>%
group_by(shooterName) %>%
mutate(left_events = sum(dist >0),
right_events = sum(dist <0),
left_prop = left_events / events,
right_prop = right_events / events) %>%
ungroup()
top_6D <- team_df %>%
filter(pos == "D") %>%
group_by(shooterName) %>%
summarize(events = mean(events)) %>%
top_n(6)
top_12F <- team_df %>%
filter(pos == "F") %>%
group_by(shooterName) %>%
summarize(events = mean(events)) %>%
top_n(12)
top_12F
top_12F <- team_df %>%
filter(pos == "F") %>%
group_by(shooterName) %>%
summarize(events = mean(events)) %>%
top_n(12) %>%
arrange(desc(events))
top_12F
team_df
subset(team_df, dist > 0)
subset(team_df, dist > 0 & shooterName %in% top_12F$shooterName)
shots <- fread(here("/data/shots_2007-2018.csv"))
shots <- data.frame(shots)
df <- shots %>%
filter(season > 2016,
yCordAdjusted != 0,
playerPositionThatDidEvent %in% c("L", "R", "C", "D"),
homeSkatersOnIce == 5,
awaySkatersOnIce == 5) %>%
select(shooterName,
playerPositionThatDidEvent,
teamCode,
season,
yCordAdjusted,
xCordAdjusted) %>%
mutate(dist = ifelse(yCordAdjusted < 0, -100 - (xCordAdjusted*-1), 100 - xCordAdjusted),
pos = ifelse(playerPositionThatDidEvent == "D", "D", "F")) %>%
group_by(shooterName) %>%
mutate(events = n())
team_df <- df %>%
group_by(shooterName) %>%
mutate(left_events = sum(dist >0),
right_events = sum(dist <0),
left_prop = left_events / events,
right_prop = right_events / events) %>%
ungroup()
View(team_df)
View(team_df %>% filter(team == "S.J"))
View(team_df %>% filter(teamCode == "S.J"))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(rvest)
library(beepr)
library(gganimate)
library(extrafont)
library(knitr)
library(here)
library(data.table)
theme_ice <- theme_bw() +
theme(
text = element_text(family = "Consolas"),
plot.title = element_text(hjust = .5),
plot.subtitle = element_text(hjust = .5),
panel.grid.minor = element_blank(),
legend.position = "bottom")
my_labs  = list(labs(caption = "IceAnalysis.com | @IceAnalysis"))
here()
shots <- fread(here("/data/shots_2007-2018.csv"))
shots <- data.frame(shots)
df <- shots %>%
filter(season > 2016,
yCordAdjusted != 0,
playerPositionThatDidEvent %in% c("L", "R", "C", "D"),
homeSkatersOnIce == 5,
awaySkatersOnIce == 5) %>%
select(shooterName,
playerPositionThatDidEvent,
teamCode,
season,
yCordAdjusted,
xCordAdjusted) %>%
mutate(dist = ifelse(yCordAdjusted < 0, -100 - (xCordAdjusted*-1), 100 - xCordAdjusted),
pos = ifelse(playerPositionThatDidEvent == "D", "D", "F")) %>%
group_by(shooterName) %>%
mutate(events = n())
team_df <- df %>%
group_by(shooterName) %>%
mutate(left_events = sum(dist >0),
right_events = sum(dist <0),
left_prop = left_events / events,
right_prop = right_events / events) %>%
ungroup()
team_df <- df %>%
filter(teamCode == "S.J") %>%
group_by(shooterName, teamCode) %>%
mutate(left_events = sum(dist >0),
right_events = sum(dist <0),
left_prop = left_events / events,
right_prop = right_events / events) %>%
ungroup()
top_6D <- t
View(team_df)
team_df <- df %>%
filter(teamCode == "S.J") %>%
group_by(shooterName, teamCode) %>%
mutate(left_events = sum(dist >0),
right_events = sum(dist <0),
left_prop = left_events / (left_events + right_events),
right_prop = right_events / (left_events + right_events)) %>%
ungroup()
View(team_df)
team_df <- df %>%
filter(teamCode == "S.J") %>%
group_by(shooterName, teamCode) %>%
mutate(left_events = sum(dist >0),
right_events = sum(dist <0),
left_prop = left_events / (left_events + right_events),
right_prop = right_events / (left_events + right_events)) %>%
ungroup()
top_6D <- team_df %>%
filter(pos == "D") %>%
group_by(shooterName) %>%
summarize(events = mean(events)) %>%
top_n(6)
top_12F <- team_df %>%
filter(pos == "F") %>%
group_by(shooterName) %>%
summarize(events = mean(events)) %>%
top_n(12) %>%
arrange(desc(events))
fchart <- ggplot() +
geom_histogram(data = subset(team_df, dist > 0 & shooterName %in% top_12F$shooterName), aes(x = dist - 11, y = -..count..), fill = "orange", binwidth = 2) +
geom_histogram(data = subset(team_df, dist < 0 & shooterName %in% top_12F$shooterName), aes(x = -dist - 11, y = ..count..), fill = "purple", binwidth = 2) +
geom_text(data = subset(team_df, dist > 0 & shooterName %in% top_12F$shooterName), aes(x = 75, y = 10, label = ifelse(right_prop >= .5, paste0(round(100*right_prop),"%"), NA)), family = "Consolas") +
geom_text(data = subset(team_df, dist < 0 & shooterName %in% top_12F$shooterName), aes(x = 75, y = -10, label = ifelse(left_prop > .5, paste0(round(100*left_prop),"%"), NA)), family = "Consolas") +
coord_flip() +
facet_wrap(~shooterName) +
theme_ice +
scale_y_continuous(expand = c(0,0)) +
geom_hline(yintercept = 0) +
theme(axis.text.x = element_blank(),
axis.text.y = element_text(),
axis.line.x = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
plot.title = element_text(hjust = .5),
plot.subtitle = element_text(hjust = .5)) +
labs(title = paste0(i, " 2016-2018 Even Strength Shots"),
subtitle = "Forwards",
y = " <- Number of Left Shots | Number of Right Shots ->",
x = "Distance from Goal") +
my_labs +
ggsave(path = here::here("static/img/pref/"), filename = paste0("F-Side-Pref-", i, ".png"), height = 9, units = "in")
dchart <- ggplot() +
geom_histogram(data = subset(team_df, dist > 0 & shooterName %in% top_6D$shooterName), aes(x = dist - 11, y = -..count..), fill = "orange", binwidth = 2) +
geom_histogram(data = subset(team_df, dist < 0 & shooterName %in% top_6D$shooterName), aes(x = -dist - 11, y = ..count..), fill = "purple", binwidth = 2) +
geom_text(data = subset(team_df, dist > 0 & shooterName %in% top_6D$shooterName), aes(x = 75, y = 10, label = ifelse(right_prop >= .5, paste0(round(100*right_prop),"%"), NA)), family = "Consolas") +
geom_text(data = subset(team_df, dist < 0 & shooterName %in% top_6D$shooterName), aes(x = 75, y = -10, label = ifelse(left_prop > .5, paste0(round(100*left_prop),"%"), NA)), family = "Consolas") +
coord_flip() +
facet_wrap(~shooterName) +
theme_ice +
scale_y_continuous(expand = c(0,0)) +
geom_hline(yintercept = 0) +
theme(axis.text.x = element_blank(),
axis.text.y = element_text(),
axis.line.x = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
plot.title = element_text(hjust = .5),
plot.subtitle = element_text(hjust = .5)) +
labs(title = paste0(i, " 2016-2018 Even Strength Shots"),
subtitle = "Defensemen",
y = "<- Number of Left Shots | Number of Right Shots ->",
x = "Distance from Goal") +
my_labs +
ggsave(path = here::here("static/img/pref/"), filename = paste0("D-Side-Pref-", i, ".png"), height = 6, units = "in")
print(fchart)
print(dchart)
dchart <- ggplot() +
geom_histogram(data = subset(team_df, dist > 0 & shooterName %in% top_6D$shooterName), aes(x = dist - 11, y = -..count..), fill = "orange", binwidth = 2) +
geom_histogram(data = subset(team_df, dist < 0 & shooterName %in% top_6D$shooterName), aes(x = -dist - 11, y = ..count..), fill = "purple", binwidth = 2) +
geom_text(data = subset(team_df, dist > 0 & shooterName %in% top_6D$shooterName), aes(x = 75, y = 15, label = ifelse(right_prop >= .5, paste0(round(100*right_prop),"%"), NA)), family = "Consolas") +
geom_text(data = subset(team_df, dist < 0 & shooterName %in% top_6D$shooterName), aes(x = 75, y = -15, label = ifelse(left_prop > .5, paste0(round(100*left_prop),"%"), NA)), family = "Consolas") +
coord_flip() +
facet_wrap(~shooterName) +
theme_ice +
scale_y_continuous(expand = c(0,0)) +
geom_hline(yintercept = 0) +
theme(axis.text.x = element_blank(),
axis.text.y = element_text(),
axis.line.x = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
plot.title = element_text(hjust = .5),
plot.subtitle = element_text(hjust = .5)) +
labs(title = paste0(i, " 2016-2018 Even Strength Shots"),
subtitle = "Defensemen",
y = "<- Number of Left Shots | Number of Right Shots ->",
x = "Distance from Goal") +
my_labs +
ggsave(path = here::here("static/img/pref/"), filename = paste0("D-Side-Pref-", i, ".png"), height = 6, units = "in")
print(dchart)
print(fchart)
team_df <- df %>%
filter(teamCode == i) %>%
group_by(shooterName, teamCode) %>%
mutate(left_events = sum(dist >0),
right_events = sum(dist <0),
left_prop = left_events / (left_events + right_events),
right_prop = right_events / (left_events + right_events),
tot_events = left_events + right_events) %>%
ungroup()
View(team_df)
team_df <- df %>%
filter(teamCode == i) %>%
group_by(shooterName, teamCode) %>%
mutate(left_events = sum(dist >0),
right_events = sum(dist <0),
left_prop = left_events / (left_events + right_events),
right_prop = right_events / (left_events + right_events),
tot_events = left_events + right_events) %>%
ungroup()
top_6D <- team_df %>%
filter(pos == "D") %>%
group_by(shooterName) %>%
summarize(events = mean(tot_events)) %>%
top_n(6) %>%
arrange(desc(events))
top_12F <- team_df %>%
filter(pos == "F") %>%
group_by(shooterName) %>%
summarize(events = mean(tot_events)) %>%
top_n(12) %>%
arrange(desc(events))
fchart <- ggplot() +
geom_histogram(data = subset(team_df, dist > 0 & shooterName %in% top_12F$shooterName), aes(x = dist - 11, y = -..count..), fill = "orange", binwidth = 2) +
geom_histogram(data = subset(team_df, dist < 0 & shooterName %in% top_12F$shooterName), aes(x = -dist - 11, y = ..count..), fill = "purple", binwidth = 2) +
geom_text(data = subset(team_df, dist > 0 & shooterName %in% top_12F$shooterName), aes(x = 75, y = 10, label = ifelse(right_prop >= .5, paste0(round(100*right_prop),"%"), NA)), family = "Consolas") +
geom_text(data = subset(team_df, dist < 0 & shooterName %in% top_12F$shooterName), aes(x = 75, y = -10, label = ifelse(left_prop > .5, paste0(round(100*left_prop),"%"), NA)), family = "Consolas") +
coord_flip() +
facet_wrap(~shooterName) +
theme_ice +
scale_y_continuous(expand = c(0,0)) +
geom_hline(yintercept = 0) +
theme(axis.text.x = element_blank(),
axis.text.y = element_text(),
axis.line.x = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
plot.title = element_text(hjust = .5),
plot.subtitle = element_text(hjust = .5)) +
labs(title = paste0(i, " 2016-2018 Even Strength Shots"),
subtitle = "Forwards",
y = " <- Number of Left Shots | Number of Right Shots ->",
x = "Distance from Goal") +
my_labs +
ggsave(path = here::here("static/img/pref/"), filename = paste0("F-Side-Pref-", i, ".png"), height = 9, units = "in")
dchart <- ggplot() +
geom_histogram(data = subset(team_df, dist > 0 & shooterName %in% top_6D$shooterName), aes(x = dist - 11, y = -..count..), fill = "orange", binwidth = 2) +
geom_histogram(data = subset(team_df, dist < 0 & shooterName %in% top_6D$shooterName), aes(x = -dist - 11, y = ..count..), fill = "purple", binwidth = 2) +
geom_text(data = subset(team_df, dist > 0 & shooterName %in% top_6D$shooterName), aes(x = 75, y = 15, label = ifelse(right_prop >= .5, paste0(round(100*right_prop),"%"), NA)), family = "Consolas") +
geom_text(data = subset(team_df, dist < 0 & shooterName %in% top_6D$shooterName), aes(x = 75, y = -15, label = ifelse(left_prop > .5, paste0(round(100*left_prop),"%"), NA)), family = "Consolas") +
coord_flip() +
facet_wrap(~shooterName) +
theme_ice +
scale_y_continuous(expand = c(0,0)) +
geom_hline(yintercept = 0) +
theme(axis.text.x = element_blank(),
axis.text.y = element_text(),
axis.line.x = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
plot.title = element_text(hjust = .5),
plot.subtitle = element_text(hjust = .5)) +
labs(title = paste0(i, " 2016-2018 Even Strength Shots"),
subtitle = "Defensemen",
y = "<- Number of Left Shots | Number of Right Shots ->",
x = "Distance from Goal") +
my_labs +
ggsave(path = here::here("static/img/pref/"), filename = paste0("D-Side-Pref-", i, ".png"), height = 6, units = "in")
print(fchart)
print(dchart)
team_df <- df %>%
filter(teamCode == "STL") %>%
group_by(shooterName, teamCode) %>%
mutate(left_events = sum(dist >0),
right_events = sum(dist <0),
left_prop = left_events / (left_events + right_events),
right_prop = right_events / (left_events + right_events),
tot_events = left_events + right_events) %>%
ungroup()
top_6D <- team_df %>%
filter(pos == "D") %>%
group_by(shooterName) %>%
summarize(events = mean(tot_events)) %>%
top_n(6) %>%
arrange(desc(events))
top_12F <- team_df %>%
filter(pos == "F") %>%
group_by(shooterName) %>%
summarize(events = mean(tot_events)) %>%
top_n(12) %>%
arrange(desc(events))
fchart <- ggplot() +
geom_histogram(data = subset(team_df, dist > 0 & shooterName %in% top_12F$shooterName), aes(x = dist - 11, y = -..count..), fill = "orange", binwidth = 2) +
geom_histogram(data = subset(team_df, dist < 0 & shooterName %in% top_12F$shooterName), aes(x = -dist - 11, y = ..count..), fill = "purple", binwidth = 2) +
geom_text(data = subset(team_df, dist > 0 & shooterName %in% top_12F$shooterName), aes(x = 75, y = 10, label = ifelse(right_prop >= .5, paste0(round(100*right_prop),"%"), NA)), family = "Consolas") +
geom_text(data = subset(team_df, dist < 0 & shooterName %in% top_12F$shooterName), aes(x = 75, y = -10, label = ifelse(left_prop > .5, paste0(round(100*left_prop),"%"), NA)), family = "Consolas") +
coord_flip() +
facet_wrap(~shooterName) +
theme_ice +
scale_y_continuous(expand = c(0,0)) +
geom_hline(yintercept = 0) +
theme(axis.text.x = element_blank(),
axis.text.y = element_text(),
axis.line.x = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
plot.title = element_text(hjust = .5),
plot.subtitle = element_text(hjust = .5)) +
labs(title = paste0(i, " 2016-2018 Even Strength Shots"),
subtitle = "Forwards",
y = " <- Number of Left Shots | Number of Right Shots ->",
x = "Distance from Goal") +
my_labs +
ggsave(path = here::here("static/img/pref/"), filename = paste0("F-Side-Pref-", i, ".png"), height = 9, units = "in")
fchart <- ggplot() +
geom_histogram(data = subset(team_df, dist > 0 & shooterName %in% top_12F$shooterName), aes(x = dist - 11, y = -..count..), fill = "orange", binwidth = 2) +
geom_histogram(data = subset(team_df, dist < 0 & shooterName %in% top_12F$shooterName), aes(x = -dist - 11, y = ..count..), fill = "purple", binwidth = 2) +
geom_text(data = subset(team_df, dist > 0 & shooterName %in% top_12F$shooterName), aes(x = 75, y = 10, label = ifelse(right_prop >= .5, paste0(round(100*right_prop),"%"), NA)), family = "Consolas") +
geom_text(data = subset(team_df, dist < 0 & shooterName %in% top_12F$shooterName), aes(x = 75, y = -10, label = ifelse(left_prop > .5, paste0(round(100*left_prop),"%"), NA)), family = "Consolas") +
coord_flip() +
facet_wrap(~shooterName) +
theme_ice +
scale_y_continuous(expand = c(0,0)) +
geom_hline(yintercept = 0) +
theme(axis.text.x = element_blank(),
axis.text.y = element_text(),
axis.line.x = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
plot.title = element_text(hjust = .5),
plot.subtitle = element_text(hjust = .5)) +
labs(title = paste0(i, " 2016-2018 Even Strength Shots"),
subtitle = "Forwards",
y = " <- Number of Left Shots | Number of Right Shots ->",
x = "Distance from Goal") +
my_labs +
ggsave(path = here::here("static/img/pref/"), filename = paste0("F-Side-Pref-", i, ".png"), height = 9, units = "in")
dchart <- ggplot() +
geom_histogram(data = subset(team_df, dist > 0 & shooterName %in% top_6D$shooterName), aes(x = dist - 11, y = -..count..), fill = "orange", binwidth = 2) +
geom_histogram(data = subset(team_df, dist < 0 & shooterName %in% top_6D$shooterName), aes(x = -dist - 11, y = ..count..), fill = "purple", binwidth = 2) +
geom_text(data = subset(team_df, dist > 0 & shooterName %in% top_6D$shooterName), aes(x = 75, y = 15, label = ifelse(right_prop >= .5, paste0(round(100*right_prop),"%"), NA)), family = "Consolas") +
geom_text(data = subset(team_df, dist < 0 & shooterName %in% top_6D$shooterName), aes(x = 75, y = -15, label = ifelse(left_prop > .5, paste0(round(100*left_prop),"%"), NA)), family = "Consolas") +
coord_flip() +
facet_wrap(~shooterName) +
theme_ice +
scale_y_continuous(expand = c(0,0)) +
geom_hline(yintercept = 0) +
theme(axis.text.x = element_blank(),
axis.text.y = element_text(),
axis.line.x = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
plot.title = element_text(hjust = .5),
plot.subtitle = element_text(hjust = .5)) +
labs(title = paste0(i, " 2016-2018 Even Strength Shots"),
subtitle = "Defensemen",
y = "<- Number of Left Shots | Number of Right Shots ->",
x = "Distance from Goal") +
my_labs +
ggsave(path = here::here("static/img/pref/"), filename = paste0("D-Side-Pref-", i, ".png"), height = 6, units = "in")
print(fchart)
print(dchart)
warnings()
warnings()
here()
shots <- fread(here("/data/shots_2007-2018.csv"))
shots <- data.frame(shots)
df <- shots %>%
filter(season > 2016,
yCordAdjusted != 0,
playerPositionThatDidEvent %in% c("L", "R", "C", "D"),
homeSkatersOnIce == 5,
awaySkatersOnIce == 5) %>%
select(shooterName,
playerPositionThatDidEvent,
teamCode,
season,
yCordAdjusted,
xCordAdjusted) %>%
mutate(dist = ifelse(yCordAdjusted < 0, -100 - (xCordAdjusted*-1), 100 - xCordAdjusted),
pos = ifelse(playerPositionThatDidEvent == "D", "D", "F")) %>%
group_by(shooterName) %>%
mutate(events = n())
save(df, "shots_1618.RData")
df <- shots %>%
filter(season > 2016,
yCordAdjusted != 0,
playerPositionThatDidEvent %in% c("L", "R", "C", "D"),
homeSkatersOnIce == 5,
awaySkatersOnIce == 5) %>%
select(shooterName,
playerPositionThatDidEvent,
teamCode,
season,
yCordAdjusted,
xCordAdjusted) %>%
mutate(dist = ifelse(yCordAdjusted < 0, -100 - (xCordAdjusted*-1), 100 - xCordAdjusted),
pos = ifelse(playerPositionThatDidEvent == "D", "D", "F")) %>%
group_by(shooterName) %>%
mutate(events = n())
save(df, file = "shots_1618.RData")
df <- load("shots_1618.RData")
load("shots_1618.RData")
save(df, file = "data/shots_1618.RData")
load("shots_1618.RData")
load("data/shots_1618.RData")
load("/data/shots_1618.RData")
load(here("/data/shots_1618.RData"))
